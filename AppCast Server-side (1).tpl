___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "AppCast Server-side",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "enterprise_id",
    "displayName": "Enterprise ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "Enterprise id, provided by Appcast representive."
  },
  {
    "type": "TEXT",
    "name": "ccuid_cookie",
    "displayName": "Ccuid (Click ID)",
    "simpleValueType": true,
    "notSetText": "Please enter the name of your Click ID cookie.",
    "help": "Enter the variable of the cookie that contains the Click ID."
  },
  {
    "type": "TEXT",
    "name": "job_id",
    "displayName": "Job ID",
    "simpleValueType": true,
    "help": "Job id inside ATS.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "job_seeker_id",
    "displayName": "Job Seeker ID (not required)",
    "simpleValueType": true,
    "help": "Job Seeker ID from the system we get quality data from. It is also known as candidate ID within many ATSs."
  },
  {
    "type": "RADIO",
    "name": "test_boolean",
    "displayName": "Testing",
    "radioItems": [
      {
        "value": 0,
        "displayValue": "False"
      },
      {
        "value": 1,
        "displayValue": "True"
      }
    ],
    "simpleValueType": true,
    "help": "Set this to true if you are testing the setup. Otherwise, use false.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "logsGroup",
    "displayName": "Logs Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "displayName": "",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const JSON = require('JSON');
const sendHttpRequest = require('sendHttpRequest');
const setCookie = require('setCookie');
const getContainerVersion = require('getContainerVersion');
const logToConsole = require('logToConsole');
const getRequestHeader = require('getRequestHeader');
const encodeUriComponent = require('encodeUriComponent');
const Object = require('Object');
const getEventData = require('getEventData');
const getTimestamp = require('getTimestampMillis');
const parseUrl = require('parseUrl');
const getCookieValues = require('getCookieValues');

const isLoggingEnabled = determinateIsLoggingEnabled();
const traceId = getRequestHeader('trace-id');

// get or set click id value as cookie

sendTrackRequest();

function sendTrackRequest() {
  let host = 'https://click.appcast.io/ss-9k/a17.png';
  const params = getRequestParams();
  const queryString = mapParamsToQueryString(params);
  const url = host + '?' + queryString;
  const headers = getRequestHeaders();

  if (isLoggingEnabled) {
    logToConsole(
      JSON.stringify({
        Name: 'AppCast',
        Type: 'Request',
        TraceId: traceId,
        EventName: params.a,
        Parameters: params,
        RequestMethod: 'GET',
        RequestUrl: url,
        RequestHeaders: headers,
      })
    );
  }
 sendHttpRequest(
  url,
  (statusCode, headers) => {
    if (isLoggingEnabled) {
      logToConsole(
        JSON.stringify({
          Name: 'AppCast',
          Type: 'Response',
          TraceId: traceId,
          EventName: params.a,
          ResponseStatusCode: statusCode,
          ResponseHeaders: headers,
        })
      );
    }
    if (!data.useOptimisticScenario) {
      if (statusCode >= 200 && statusCode < 400) {
        data.gtmOnSuccess();
      } else {
        data.gtmOnFailure();
      }
    }
  },
  {
    headers: headers,
    method: 'GET'  // Explicitly set the method to GET
  }
);
}

function getRequestParams() {
  
  const timestamp = getTimestamp();
  let params = {
    tp: 1,
    ent: data.enterprise_id,
    ccuid: data.ccuid_cookie,
    ts: timestamp,
    jsid: data.job_seeker_id,
    jid: data.job_id,
    test: data.test_boolean || 0
  };  
  return params;
}

function getRequestHeaders() {
  return {
    'X-Forwarded-For': getRequestHeader('X-Forwarded-For'),
    'User-Agent': 'ss-integration',
    'Referer': getRequestHeader('Referer'),
  };
}

function mapParamsToQueryString(params) {
  return Object.keys(params)
    .map((key) => key + '=' + encodeUriComponent(params[key]))
    .join('&');
}

function determinateIsLoggingEnabled() {
  const containerVersion = getContainerVersion();
  const isDebug = !!(
    containerVersion &&
    (containerVersion.debugMode || containerVersion.previewMode)
  );

  if (!data.logType) {
    return isDebug;
  }

  if (data.logType === 'no') {
    return false;
  }

  if (data.logType === 'debug') {
    return isDebug;
  }

  return data.logType === 'always';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "remoteAddressAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ccuid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 02/05/2021, 09:39:23


